{% extends 'layouts/base.html' %}

{% load static %}


{% block title %} {{ title }} {% endblock %}



{% block extra_head %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/unpoly@3.7.3/unpoly.min.css">
{% endblock %}


{% block display %}
    {% if request.mode != 'view' %}
        <!-- A place holder for keep success image list and fail image list -->
        <div id="success-image-list" up-hungry style="display: none;">
            {% for image in success_images_list %}
                <img src="{{ image }}" alt="Success Image" />
            {% endfor %}
        </div>

        <div id="fail-image-list" up-hungry style="display: none;">
            {% for image in fail_images_list %}
                <img src="{{ image }}" alt="Fail Image" />
            {% endfor %}
        </div>

        <!-- A place holder for displaying modal -->
        <div id="modal" up-hungry></div>
    

        <!-- Navigation bar -->
        {% include 'components/nav_bar.html' %}
    {% endif %}



    <!-- The main display -->
    {% if page == 'attendance' %}
        <main class="flex mt-4 gap-3">
            <div class="overflow-y-scroll w-full pr-2" style="height: 90vh;">
                {% include 'components/title_bar.html' %}
                {% include 'components/display_attendance_calendar.html' %}
            </div>
        </main>
    {% elif page == 'announcements' %}
        <main class="flex mt-4 gap-3">
            <div class="overflow-y-scroll w-full pr-2" style="height: 90vh;">
                {% include 'components/title_bar.html' %}
                {% include 'components/announcements.html' %}
            </div>
        </main>
    {% else %}
        <main class="flex flex-col mt-4 gap-3">
            <!-- Keep the display fit the screen, only content inside can be scrolled -->
            <div class="overflow-y-scroll w-full pr-2 pb-20" style="height: 90vh;">
                {% if page == "dashboard" %}
                    {% include 'components/dashboard.html' %}
                {% elif page == 'classroom_exams' %}
                    {% include 'components/classroom_exams.html' %}
                {% else %}
                    <!-- The title bar -->
                    {% include 'components/title_bar.html' %}
                    <!-- The tool bar for database filter, sort and more -->
                    {% include 'components/db_tool_bar.html' %}
                    {% include 'components/calculation_section.html' %}
                    <!-- The cards display -->
                    {% include 'components/display_cards.html' %}

                {% endif %}
            </div>
            {% if is_paginated %}
            <nav id="pagination" aria-label="Page navigation" class="flex justify-center fixed bottom-0 right-0 bg-[#F0F2F5] dark:bg-slate-900" style="width: 100vw; height: 50px;">
              <ul class="inline-flex items-center -space-x-px">
                {% if page_obj.has_previous %}
                  <li>
                    <a href="?page={{ page_obj.previous_page_number }}{% if pagination_query_string %}&{{ pagination_query_string }}{% endif %}"
                        up-preload
                    class="px-3 md:px-7 py-2 leading-tight ml-0 text-gray-500 bg-white border border-gray-300 rounded-l-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white transition">
                      Previous
                    </a>
                  </li>
                {% else %}
                  <li>
                    <span class="px-3 md:px-7 py-2 leading-tight ml-0 text-gray-400 bg-gray-100 border border-gray-300 rounded-l-lg cursor-not-allowed dark:bg-gray-700 dark:border-gray-600 dark:text-gray-500">
                      Previous
                    </span>
                  </li>
                {% endif %}

                {% for num in paginator.page_range %}
                  {% if num == 1 or num == paginator.num_pages or num >= page_obj.number|add:"-2" and num <= page_obj.number|add:"2" %}
                    {% if num == 1 and page_obj.number > 3 %}
                      <li>
                        <a href="?page={{ num }}{% if pagination_query_string %}&{{ pagination_query_string }}{% endif %}"
                        up-preload
                        class="px-3 md:px-7 py-2 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white transition">
                          {{ num }}
                        </a>
                      </li>
                      {% if page_obj.number > 4 %}
                        <li>
                          <span class="px-3 md:px-7 py-2 leading-tight text-gray-500 bg-white border border-gray-300 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400">...</span>
                        </li>
                      {% endif %}
                    {% elif num == paginator.num_pages and page_obj.number < paginator.num_pages|add:"-3" %}
                      {% if page_obj.number < paginator.num_pages|add:"-4" %}
                        <li>
                          <span class="px-3 md:px-7 py-2 leading-tight text-gray-500 bg-white border border-gray-300 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400">...</span>
                        </li>
                      {% endif %}
                      <li>
                        <a href="?page={{ num }}{% if pagination_query_string %}&{{ pagination_query_string }}{% endif %}"
                        up-preload
                        class="px-3 md:px-7 py-2 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white transition">
                          {{ num }}
                        </a>
                      </li>
                    {% elif num >= page_obj.number|add:"-2" and num <= page_obj.number|add:"2" %}
                      {% if page_obj.number == num %}
                        <li>
                          <span class="px-3 md:px-7 py-2 leading-tight text-white bg-blue-600 border border-blue-600">{{ num }}</span>
                        </li>
                      {% else %}
                        <li>
                          <a href="?page={{ num }}{% if pagination_query_string %}&{{ pagination_query_string }}{% endif %}"
                          up-preload
                          class="px-3 md:px-7 py-2 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white transition">
                            {{ num }}
                          </a>
                        </li>
                      {% endif %}
                    {% endif %}
                  {% endif %}
                {% endfor %}

                {% if page_obj.has_next %}
                  <li>
                    <a href="?page={{ page_obj.next_page_number }}{% if pagination_query_string %}&{{ pagination_query_string }}{% endif %}"
                        up-preload
                    class="px-3 md:px-7 py-2 leading-tight text-gray-500 bg-white border border-gray-300 rounded-r-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white transition">
                      Next
                    </a>
                  </li>
                {% else %}
                  <li>
                    <span class="px-3 md:px-7 py-2 leading-tight text-gray-400 bg-gray-100 border border-gray-300 rounded-r-lg cursor-not-allowed dark:bg-gray-700 dark:border-gray-600 dark:text-gray-500">
                      Next
                    </span>
                  </li>
                {% endif %}
              </ul>
            </nav>
            {% else %}
            <nav id="pagination"></nav>
            {% endif %}
        </main>

    {% endif %}

{% endblock %}



{% block extra_script %}
    <script src="https://cdn.jsdelivr.net/npm/unpoly@3.7.3/unpoly.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tsparticles/confetti@3.0.3/tsparticles.confetti.bundle.min.js"></script>
    <script src="/static/js/main.js?v={{ STATIC_VERSION }}"></script>
    <script src="/static/js/classroom.js?v={{ STATIC_VERSION }}"></script>
{% endblock %}