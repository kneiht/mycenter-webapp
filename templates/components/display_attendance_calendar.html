{% load custom_tags %}

<!-- Payment Selection Dropdown -->
<div class="col-xl-4 col-lg-5 col-md-6 d-flex align-items-center">
    <select id="paymentFilter" class="form-input" onchange="window.location.href = '{{ request.path }}?get=calendar&student_id=' + {{ student.id }} + '&payment_id=' + this.value;">
        <option value="all">Select Payment to Filter</option>
        {% for payment in payments %}
        <option value="{{ payment.id }}" {% if payment.id|stringformat:"s" == selected_payment_id %}selected{% endif %}>
            {{ payment.created_at|date:"d-m-Y" }} - {{ payment.student.name }} - Đóng {{ payment.amount|format_vnd }} - HP tăng thêm {{ payment.student_balance_increase|format_vnd }}
        </option>

        {% endfor %}
        <option value="unpaid">Unpaid lessons</option>
    </select>
</div>

<div id="display_attendance_calendar" class="my-5">
    {% for month in months %}
    <div class="card w-full p-4 my-5">
        <div  class="text-center text-theme">{{ month.month }}</div>  <!-- Display the month -->
        <div class="grid grid-cols-7 justify-between gap-4">
            <div class="text-center text-theme">Mon</div>
            <div class="text-center text-theme">Tue</div>
            <div class="text-center text-theme">Wed</div>
            <div class="text-center text-theme">Thu</div>
            <div class="text-center text-theme">Fri</div>
            <div class="text-center text-theme">Sat</div>
            <div class="text-center text-theme">Sun</div>
        </div>
        
        <div class="grid grid-cols-7 justify-between gap-4">
                {% for day in month.days %}
                    <div class="text-center p-2 border rounded">
                        <div>{{ day.date.day }}</div>
                        {% for attendance in day.attendances %}
                            {{ attendance.check_class }}
                            <!-- Example: You might want to customize this based on your attendance model -->
                            {% if attendance.status == 'present' %}
                                <span class="text-green-500">Present</span>
                            {% elif attendance.status == 'absent' %}
                                <span class="text-red-500">Absent</span>
                            {% else %}
                                <span class="text-yellow-500">{{ attendance.status }}</span>
                            {% endif %}
                            {{ attendance.is_payment_required }}
                        {% endfor %}
                    </div>
                {% endfor %}
        
        </div>
        
    </div>
    {% endfor %}
</div>

