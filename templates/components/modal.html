
{% if modal == 'modal_message' %}
    <div id="modal_message" up-hungry>
        <div class="modal z-50 fixed inset-0 bg-slate-600 bg-opacity-80 overflow-y-auto h-full w-full flex justify-center">

            <!-- Modal Content -->
            <div class="relative top-20 mx-4 card h-fit w-full sm:w-fit">
                <h3 class="mt-7 mb-8 text-xl font-extrabold leading-6 text-center text-theme">Message</h3>

                <div class="w-[300px] gap-4 px-6 flex justify-center">
                    <p class="text-theme"> {{ message }} </p>
                </div>

                <div class="flex justify-center items-center gap-5 pt-8 pb-7">
                    <button id='cancel' type="button" class="btn btn-primary rounded-full w-36">
                        OK
                    </button>
                </div>

            </div>
        </div>
    </div>
{% elif modal != 'modal_message' %}  
    <div id="modal_form" up-hungry>
        <div class="modal z-50 fixed inset-0 bg-slate-600 bg-opacity-80 overflow-y-auto h-full w-full flex justify-center">

            <!-- Modal Content -->
            <div class="relative top-20 mx-4 card h-fit w-full sm:w-fit">
                <h3 class="mt-7 mb-8 text-xl font-extrabold leading-6 text-center text-theme">{% if record_id %} Edit Information {% else %} Create New {% endif %}</h3>

                <!-- Result could be a html card if success or a new form modal with error if fail, if success, the card will be added right after the div cards, else the form will be the same place but display as fixed -->
                <form enctype="multipart/form-data" method="post"
                    {% if record_id %}
                        action="{{ base_url }}{{ record_id }}"
                        up-target="#modal_form:maybe, #modal_message:maybe, #record_{{ record_id }}:maybe"
                    {% else %}]
                        action="{{ base_url }}"
                        up-target="#modal_form:maybe, #modal_message:maybe, #display_cards:before:maybe"
                    {% endif %} >



                    {% if form.fields|length >= 5 or modal == 'modal_class' %}
                    <div class="grid grid-cols-1 sm:grid-cols-2 sm:w-[600px] gap-4 px-6">
                    {% else %}
                    <div class="grid grid-cols-1 w-[400px]  gap-4 px-6">
                    {% endif %}

                        {% if form.non_field_errors %}
                            {% for error in form.non_field_errors %}
                            <p class="text-red-500 pt-3">{{ error }}</p>
                            {% endfor %}
                        {% endif %}

                        {% csrf_token %}
                        <input type="hidden" name="school_id" value="{{ school_id }}">
                        {% for field in form %}
                            <div class="">
                                {% if field.name != 'students' %}
                                    <div>
                                        <label for="{{ field.name }}" class="text-theme">{{ field.label }}</label>
                                        {{ field }}    
                                    
                                        {% if field.help_text %}
                                            <p class="text-blue-500 px-3">{{ field.help_text }}</p>
                                        {% endif %}
                                        {% for error in field.errors %}
                                            <p class="text-red-500 px-3">{{ error }}</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        {% endfor %}
                    </div>

                    {% if modal == 'modal_class' %}
                        <div class="sm:w-[600px] pt-4 px-6">
                            <label for="students" class="text-theme">Students</label>
                            <div class="form-input flex flex-col h-52 gap-4 pt-4 pb-6 overflow-y-scroll">
                                <div class="border-b pb-0.5 flex justify-between w-full">
                                    <span class="w-4/6"> Name </span>
                                    <span class="w-1/6 text-center"> Add </span>
                                    <span class="w-1/6 text-center"> Paid class </span>
                                </div>
                                {% for student in form.get_students %}
                                    <div class="border-b pb-0.5 flex justify-between w-full">
                                        <span class="w-4/6"> {{ student.name }} </span>
                                        <span class="w-1/6 text-center">
                                            <input type="checkbox" class="checkbox" name="students" value="{{ student.id }}" {% if student.in_class %} checked {% endif %}>
                                        </span>
                    
                                        <span class="w-1/6 text-center">
                                            <input type="checkbox" class="checkbox" name="payment_required" value="{{ student.id }}" {% if student.is_payment_required %} checked {% endif %}>
                                        </span>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    {% endif %}



                    <div class="flex justify-center items-center gap-5 pt-8 pb-7">
                        <button type="submit" class="btn btn-primary rounded-full w-36">
                            {% if record_id %} Update {% else %} Create {% endif %}
                        </button>
                        <button id='cancel' type="button" class="btn btn-secondary rounded-full w-36">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
{% endif %}