{% extends "layouts/base.html" %}
{% load static %}

{% block title %}
{{ class.name }} - {{ class.course }}
{% endblock %}

{% block extra_style %}

{% endblock %}

                                        


{% block content %}
<div class="container-fluid py-4">
    <div class="row align-items-center">
        <div class="col-xl-6 col-lg-6 col-md-12 d-flex align-items-center mb-3 mb-lg-0">
            <h3 class="me-2">{{ class.name }} - {{ class.course }}</h3>
            <a class="create-modal-form hover-pointer" data-id-record="{{ class.id }}" data-model-name="class" title="Edit">
                <i class="fas fa-cog fa-lg text-muted"></i>
            </a>
        </div>
        <div class="col-xl-4 col-lg-5 col-md-6 d-flex align-items-center">
            <input type="date" class="form-control custom-date" id="attendance-date" name="attendance_date" value="" required>
            <button id="attendanceButton" type="button" class="btn btn-raised btn-primary ms-3 mt-3" data-id-record="" data-model-name="class">Attendance</button>
        </div>
    </div>

    <div class="row">
        <!-- First column -->
        <div class="col-lg-4">
            <p class="mb-2">
                <i class="text-info fas fa-calendar-alt mr-2"></i>
                <span>Schedule: {{ class.schedule }}</span>
            </p>
            <p class="mb-2">
                <i class="text-info fas fa-chalkboard-teacher mr-2"></i>
                <span>Teacher: {{ class.teacher }}</span>
            </p>
        </div>
        <!-- Second column -->
        <div class="col-lg-5">
            <p class="mb-2">
                <i class="text-info fas fa-info-circle mr-2"></i>
                <span>Status: {{ class.status }}</span>
            </p>
            <p class="mb-2">
                <i class="text-info fas fa-sticky-note mr-2"></i>
                <span>Notes: {{ class.note }}</span>
            </p>
        </div>
    </div>
</div>


<div class="container-fluid">
    <!-- Attendance Control Bar (Initially hidden) -->
    <div id="attendanceControlBar" class="classroom-control-bar" style="display: none;">
        <div class="row justify-content-center align-items-center">

            <!-- Instructions -->
            <div class="col-12 col-md-5 text-center mb-md-0  no-wrap text-center">
                <div class="d-flex justify-content-center align-items-center flex-wrap">
                    
                    <div style="display: flex; flex-wrap: wrap; justify-content: center; align-items: center;">
                        <span class="attendance-badge background-status-not_checked" >Not Checked</span>
                        <span class="attendance-badge background-status-present">Present</span>
                        <span class="attendance-badge background-status-absent">Absent</span>
                        <span class="attendance-badge background-status-late">Late</span>
                        <span class="attendance-badge background-status-left_early">Left Early</span>
                    </div>
                    <p>Click the student to check attendance.</p>
                </div>
            </div>


            <!-- Learning hours -->
            <div class="col-12 col-md-3 text-center px-5">
                <div class="d-flex justify-content-center align-items-center flex-wrap">
                    <select name="learningHours" id="learningHours" class="form-select">
                      <option value="" selected="">---------</option>
                      <option value="1.5">1 hour 30 minutes</option>
                      <option value="1">1 hour</option>
                      <option value="2">2 hours</option>
                      <option value="0.75">45 minutes</option>
                      <option value="0.5">30 minutes</option>
                      <option value="0.25">15 minutes</option>
                    </select>
                    <p>Select learning hours</p>
                </div>
            </div>


            <!-- Attendance confirm button -->
            <div class="col-12 col-md-4 text-center">
                <div class="d-flex justify-content-center align-items-center flex-wrap">
                    <button id="confirmAttendanceBtn" class="btn btn-primary mx-3">Confirm</button>
                    <button id="cancelAttendanceBtn" class="btn btn-secondary mx-3">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <div id="moneyControlBar" class="classroom-control-bar">
        <div class="row justify-content-center align-items-center">
            <!-- Select All & Deselect All Buttons -->
            <div class="col-12 col-md-6 text-center mb-md-0  no-wrap">
                <div class="d-flex justify-content-center align-items-center flex-wrap">
                    <button id="selectAllBtn" class="btn btn-primary">Select All</button>
                    <button id="deselectAllBtn" class="btn btn-secondary  ms-3">Deselect All</button>
                </div>
            </div>
            <!-- Money Buttons and Input -->
            <div class="col-12 col-md-6 text-center">
                <div class="d-flex justify-content-center align-items-center flex-wrap">
                    <button id="subtractMoneyBtn" class="btn btn-danger btn-raised mr-2 mb-2">Oh no</button>
                    <input type="number" id="globalMoneyChange" value="1" class="form-control money-input mb-2">
                    <button id="addMoneyBtn" class="btn btn-success btn-raised mb-2">Wow</button>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="container-fluid mt-5">
        <!-- Bootstrap Container -->
        <div class="row">
            <!-- Bootstrap Row -->
            {% for student in students %}
                <div class="searchable col-lg-2 col-md-3 col-sm-6 col-6 mb-3">
                    <div class="card card-student-with-big-image" data-student-id="{{ student.id }}">
                        <!-- Assuming you have a student_detail URL pattern. Adjust accordingly if different. -->
                        <!-- Display the image from the student object -->
                        {% if student.image %}
                        <div class="image-container">
                            <img class="w-100" src="{{ student.image.url }}" alt="{{ student.name }}">
                        </div>
                        {% else %}
                        <!-- Placeholder image or text if no image is available -->
                        <div class="image-container no-image text-center">
                            No Image
                        </div>
                        {% endif %}
                        <!-- Add money display on the top right of the card -->
                        <div class="money-display position-absolute p-2">
                            <p class="money-display-text">{{ student.money }}</p>
                        </div>
                        <div class="card-body p-1">

                            <a class="create-modal-form hover-pointer" data-id-record="{{ student.id }}" data-model-name="student">
                                <p class="mb-0 text-center text-bold">{{ student.name }}</p>
                                <!-- Increased margin-bottom to mb-3 -->
                            </a>
                        </div>
                    </div>
                </div>
            {% endfor %}

        </div>
        <!-- End of Bootstrap Row -->
    <!-- End of Bootstrap Container -->
</div>




{% endblock %}


{% block extra_script %}
{% include "includes/js/notification_control.js" %}
{% include "includes/js/modal_form.js" %}
{% include "includes/js/class_attendance.js" %}
{% include "includes/js/handle_student_money.js" %}
{% endblock %}