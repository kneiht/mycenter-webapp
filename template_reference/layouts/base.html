{% load i18n static admin_soft %}
{% get_current_language as LANGUAGE_CODE %}
{% get_current_language_bidi as LANGUAGE_BIDI %}
{% get_direction as direction %}
{% get_admin_setting as admin_setting %}

<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE|default:"en-us" }}">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <title>{% block title %}{% endblock %}</title>

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="76x76" href="{% static 'img/apple-icon.png' %}">
    <link rel="icon" type="image/png" href="{% static 'img/favicon.png' %}">

    <!-- Fonts and Icons -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet" />
    <link href="{% static 'css/nucleo-icons.css' %}" rel="stylesheet" />
    <link href="{% static 'css/nucleo-svg.css' %}" rel="stylesheet" />
    <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>

    <!-- CSS Files -->
    <link id="pagestyle" href="{% static 'css/soft-ui-dashboard.css' %}" rel="stylesheet" />
    <link id="pagestyle_dark" href="{% static 'css/dark-theme-core.css' %}" rel="stylesheet" />
    <link id="style" href="{% static 'css/styles.css' %}" rel="stylesheet" />

    <!-- Custom Style -->
    <style>
    </style>

    {% block extrahead %}{% endblock extrahead %}
    {% block extra_style %}{% endblock %}
</head>

<body class="g-sidenav-show bg-gray-100">
    {% include "includes/sidebar_toggle.html" %}
    <main class="main-content position-relative max-height-vh-100 h-100 border-radius-lg ">
        {% include "includes/navigation.html" %} 

        {% if messages %}
        <div class="messages">
            {% for message in messages %}
            <div{% if message.tags %} class="alert {{ message.tags }}-alert"{% endif %}>
                {{ message }}
                <span class="close-alert" onclick="this.parentElement.style.display='none';">&times;</span>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        {% block content %}{% endblock content %}


        <div id="modalPlaceHolder">
            <!-- The modal form will be loaded here by JavaScript -->
        </div>

        <div id="notificationModal" role="dialog" tabindex="-1" class="notification-modal">
            <!-- Modal content -->
            <div class="notification-modal-content">
                <div id="notification-modal-body"></div>
            </div>
        </div>

        <div id="confirmationModal" class="modal modal-small fade" tabindex="-1" role="dialog">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Confirm Action</h5>
              </div>
              <div class="modal-body">
                <p id="confirmMessage">Your message here.</p>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="confirmBtn">Confirm</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>

              </div>
            </div>
          </div>
        </div>

        <div id="alertModal" class="modal modal-small fade" tabindex="-1" role="dialog">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Alert</h5>
              </div>
              <div class="modal-body">
                <p id="alertMessage">Your message here.</p>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              </div>
            </div>
          </div>
        </div>


    </main>




    <!-- jQuery and Bootstrap Bundle (includes Popper) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- Core JS Files -->
    {% include 'includes/scripts.html' %}
    {% block scripts %}{% endblock scripts %}

    <script>
        var win = navigator.platform.indexOf('Win') > -1;
        if (win && document.querySelector('#sidenav-scrollbar')) {
            var options = {
                damping: '0.5'
            }
            Scrollbar.init(document.querySelector('#sidenav-scrollbar'), options);
        }
    </script>
    <script>
        // CSRF token setup for AJAX requests
        $.ajaxSetup({
            beforeSend: function(xhr, settings) {
                if (!this.crossDomain) { // Only send the token to internal URLs
                    xhr.setRequestHeader("X-CSRFToken", getCookie('csrftoken'));
                }
            }
        });
        
        // Function to get the value of a cookie by its name
        function getCookie(name) {
            var cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                var cookies = document.cookie.split(';');
                for (var i = 0; i < cookies.length; i++) {
                    var cookie = jQuery.trim(cookies[i]);
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
    </script>

    <script>
        // Get the sidebar and logo text elements
        var sidebar = document.querySelector('.sidenav');
        var logoText = document.querySelector('.logo-text');
        var expandTimer; // Variable to hold the timer

        // Function to expand the sidebar
        function expandSidebar() {
            // Set a timer to expand the sidebar after 1 second
            expandTimer = setTimeout(function() {
                sidebar.classList.remove('navbar-thin');
                logoText.style.display = ''; // Show the logo text when expanded
            }, 500);
        }

        // Function to collapse the sidebar
        function collapseSidebar() {
            // Clear the timer if it exists
            if (expandTimer) {
                clearTimeout(expandTimer);
            }

            // Collapse the sidebar immediately
            sidebar.classList.add('navbar-thin');
            logoText.style.display = 'none'; // Hide the logo text when collapsed
        }

        // Attach the event listeners to the sidebar
        sidebar.addEventListener('mouseenter', expandSidebar);
        sidebar.addEventListener('mouseleave', collapseSidebar);
    </script>



    <script>
        function showConfirmationModal(message, callback) {
            // Set the custom message
            $('#confirmMessage').text(message);
            $('#confirmationModal').modal('show');

            $('#confirmBtn').off('click').on('click', function() {
                $('#confirmationModal').modal('hide');
                callback();
            });
        }
        function showAlertModal(message) {
            $('#alertMessage').text(message);
            $('#alertModal').modal('show');
        }
    </script>
    <!-- Control Center for Soft Dashboard: parallax effects, scripts for the example pages etc -->
    <script src="{% static 'js/soft-ui-dashboard.min.js' %}"></script>
    <script src="{% static 'js/scripts.js' %}"></script>
    


    {% block extra_script %}
    {% endblock extra_script %}
</body>

</html>

